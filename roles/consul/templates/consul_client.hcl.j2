# Enable client mode
server = false

# Client Configuration
datacenter = "dc1"

# Networking Configuration
bind_addr = "0.0.0.0"   # Listen on all network interfaces
advertise_addr = "{{ consul_advertise_addr }}" # Dynamic based on Ansible variables
client_addr = "0.0.0.0" # Listen on all available IP addresses

retry_join = {{ consul_retry_join | to_json }}

# Data Directory
data_dir = "/etc/consul.d/data"

# TLS Configuration
tls {
  ca_file   = "/etc/ssl/consul_ca.crt"
  cert_file = "/etc/ssl/consul.crt"
  key_file  = "/etc/ssl/consul.key"
  verify_incoming = true
  verify_outgoing = true
}

# Encryption
encrypt = "{{ consul_encryption_key }}"

# Logging Configuration
log_file = "/etc/consul.d/consul.log"
log_rotate_bytes = 10485760 # Rotate log file after 10 MB
log_rotate_duration = "24h" # Rotate log file daily
log_rotate_max_files = 7    # Keep 7 rotated log files
log_level = "INFO"          # Log verbosity level

# UI Configuration
ui_config {
  enabled = false
}

# ACL Configuration
acl {
  enabled = false
}

# Connect Configuration
connect {
  enabled = true
}

# Ports Configuration
ports {
  http  = -1   # Disable HTTP
  https = 8501 # Use HTTPS on port 8501
}
